import{h as z,j as e,B as r,m as n,t,ag as R,L as H,n as P,o as V,p as T,a8 as C,ah as D,S as E,r as x,I as U,am as w,P as g,C as q}from"./index-Bxr5mO_H.js";import{u as M}from"./notistack.esm-2ii-TFc-.js";import{A as S}from"./Alert-CSFYCpaa.js";import{L as F}from"./LinearProgress-xs9CA9qh.js";import{G as c}from"./Grid-C4lt9ccn.js";import{P as N}from"./People-B6zJXbPs.js";import"./useSlot-CL1GQppj.js";const O=z(e.jsx("path",{d:"M12 7V3H2v18h20V7zM6 19H4v-2h2zm0-4H4v-2h2zm0-4H4V9h2zm0-4H4V5h2zm4 12H8v-2h2zm0-4H8v-2h2zm0-4H8V9h2zm0-4H8V5h2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8zm-2-8h-2v2h2zm0 4h-2v2h2z"}),"Business"),W=z(e.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh");function v({data:s}){if(!s||s.length===0)return e.jsx(S,{severity:"info",sx:{mt:2},children:"No recent assessment data available for charting."});const a=s.length,i=s[0]?.title||"N/A";return e.jsxs(r,{sx:{p:1},children:[e.jsx(n,{variant:"h6",color:"primary",gutterBottom:!0,children:"Assessment Trends (Mock Chart)"}),e.jsx(r,{sx:{height:300,bgcolor:"action.hover",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:1},children:e.jsx(n,{variant:"body2",color:"text.secondary",children:"[Placeholder for Chart Visualization]"})}),e.jsxs(n,{variant:"body2",sx:{mt:2},children:["Showing data for ",e.jsx("strong",{children:a})," recent assessments."]}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:["Latest entry: ",i]})]})}v.propTypes={data:t.arrayOf(t.object)};v.defaultProps={data:[]};function k({activities:s=[]}){return s.length?e.jsxs(r,{sx:{p:2},children:[e.jsx(n,{variant:"h6",color:"primary",gutterBottom:!0,children:"Recent User Activity"}),e.jsx(H,{dense:!0,children:s.map((a,i)=>e.jsx(P,{divider:!0,children:e.jsx(V,{primary:a.title,secondary:new Date(a.date).toLocaleString()})},i))}),e.jsx(r,{textAlign:"center",mt:2,children:e.jsx(T,{variant:"outlined",color:"primary",size:"small",children:"View All"})})]}):e.jsx(S,{severity:"info",sx:{mt:2},children:"No user activity found."})}k.propTypes={activities:t.arrayOf(t.shape({title:t.string.isRequired,date:t.string.isRequired}))};const $=R.memo(k);function h({title:s,value:a,icon:i,loading:p,trend:o}){const l=C(),d={up:l.palette.success.main,down:l.palette.error.main,neutral:l.palette.warning.main};return e.jsx(g,{elevation:2,sx:{p:3,height:"100%",borderRadius:2,position:"relative",overflow:"hidden","&:after":{content:'""',position:"absolute",bottom:0,left:0,right:0,height:4,backgroundColor:d[o]||"transparent"}},children:e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(r,{children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",children:s}),e.jsx(n,{variant:"h4",fontWeight:"bold",children:p?"--":a.toLocaleString()})]}),e.jsx(r,{sx:{display:"flex",alignItems:"center",color:l.palette.primary.main},children:R.cloneElement(i,{fontSize:"large",color:i.props.color||"primary"})})]})})}h.propTypes={title:t.string.isRequired,value:t.number.isRequired,icon:t.node.isRequired,loading:t.bool,trend:t.oneOf(["up","down","neutral"])};h.defaultProps={loading:!1,trend:"neutral"};function _(){const s=C(),a=D(s.breakpoints.down("md")),{claims:i}=E(),{enqueueSnackbar:p}=M(),[o,l]=x.useState(!0),[d,I]=x.useState({assessments:0,activeUsers:0,organizations:0,completions:0}),[B,L]=x.useState([]),m=i?localStorage.getItem("token"):null,j=i?.role==="admin",f=x.useCallback(async()=>{l(!0);try{if(!m)throw new Error("Authentication token not found");const u=await fetch("/api/admin/stats",{headers:{Authorization:`Bearer ${m}`}}),y=await u.json();if(!u.ok)throw new Error(y.message||"Failed to fetch stats");I(y);const b=await fetch("/api/admin/assessments",{headers:{Authorization:`Bearer ${m}`}}),A=await b.json();if(!b.ok)throw new Error(A.message||"Failed to fetch assessments");L(A)}catch(u){console.error("Error fetching dashboard data:",u),m&&p("Failed to load dashboard data: "+(u.message||"Network error"),{variant:"error",autoHideDuration:3e3})}finally{l(!1)}},[m,p]);return x.useEffect(()=>{j&&f()},[j,f]),j?e.jsxs(r,{sx:{p:a?1:3},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(n,{variant:"h4",component:"h1",fontWeight:"bold",children:"Admin Dashboard"}),e.jsx(U,{onClick:f,"aria-label":"refresh dashboard data",disabled:o,children:e.jsx(W,{})})]}),o&&e.jsx(F,{sx:{mb:3}}),e.jsxs(c,{container:!0,spacing:a?1:3,sx:{mb:3},children:[e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"Total Assessments",value:d.assessments,icon:e.jsx(w,{color:"primary"}),loading:o,trend:"up"})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"Active Users",value:d.activeUsers,icon:e.jsx(N,{color:"secondary"}),loading:o,trend:"up"})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"Organizations",value:d.organizations,icon:e.jsx(O,{color:"success"}),loading:o,trend:"neutral"})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"Completions",value:d.completions,icon:e.jsx(w,{color:"info"}),loading:o,trend:"up"})})]}),e.jsxs(c,{container:!0,spacing:a?1:3,children:[e.jsx(c,{item:!0,xs:12,md:8,children:e.jsxs(g,{elevation:2,sx:{p:2,height:"100%",borderRadius:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Recent Assessments Activity"}),o?e.jsx(r,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(q,{})}):e.jsx(v,{data:B})]})}),e.jsx(c,{item:!0,xs:12,md:4,children:e.jsxs(g,{elevation:2,sx:{p:2,height:"100%",borderRadius:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"User Activity Feed"}),e.jsx($,{})]})})]})]}):e.jsx(r,{sx:{p:3,textAlign:"center"},children:e.jsx(n,{variant:"h6",color:"error",children:"You don't have permission to access this page."})})}export{_ as default};
