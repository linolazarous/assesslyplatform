import{g as T,a as U,r as i,u as N,_ as W,b as w,j as e,s as $,d as D,m as C,e as S,f as O,h as I,S as V,q as _,U as q,B as b,I as B,p as A,C as G,D as H,V as J}from"./index-Bxr5mO_H.js";import{u as Y}from"./notistack.esm-2ii-TFc-.js";import{T as E}from"./TextField-C5nTOOG9.js";import{u as K,F as Q,S as X}from"./Select-DZCMXPxL.js";import{M as P}from"./MenuItem-LevUaqkI.js";import"./useControlled-BWtu2dAB.js";function Z(n){return U("MuiInputAdornment",n)}const M=T("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var z;const ee=["children","className","component","disablePointerEvents","disableTypography","position","variant"],te=(n,t)=>{const{ownerState:o}=n;return[t.root,t[`position${S(o.position)}`],o.disablePointerEvents===!0&&t.disablePointerEvents,t[o.variant]]},se=n=>{const{classes:t,disablePointerEvents:o,hiddenLabel:l,position:a,size:p,variant:c}=n,x={root:["root",o&&"disablePointerEvents",a&&`position${S(a)}`,c,l&&"hiddenLabel",p&&`size${S(p)}`]};return O(x,Z,t)},ne=$("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:te})(({theme:n,ownerState:t})=>w({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(n.vars||n).palette.action.active},t.variant==="filled"&&{[`&.${M.positionStart}&:not(.${M.hiddenLabel})`]:{marginTop:16}},t.position==="start"&&{marginRight:8},t.position==="end"&&{marginLeft:8},t.disablePointerEvents===!0&&{pointerEvents:"none"})),ae=i.forwardRef(function(t,o){const l=N({props:t,name:"MuiInputAdornment"}),{children:a,className:p,component:c="div",disablePointerEvents:x=!1,disableTypography:f=!1,position:y,variant:s}=l,m=W(l,ee),r=K()||{};let v=s;s&&r.variant,r&&!v&&(v=r.variant);const h=w({},l,{hiddenLabel:r.hiddenLabel,size:r.size,disablePointerEvents:x,position:y,variant:v}),j=se(h);return e.jsx(Q.Provider,{value:null,children:e.jsx(ne,w({as:c,ownerState:h,className:D(j.root,p),ref:o},m,{children:typeof a=="string"&&!f?e.jsx(C,{color:"text.secondary",children:a}):e.jsxs(i.Fragment,{children:[y==="start"?z||(z=e.jsx("span",{className:"notranslate",children:"â€‹"})):null,a]})}))})}),oe=I(e.jsx("path",{d:"M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"}),"Google"),re=I(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),ie=I(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff");function he({disableSignup:n=!1}){const{logout:t}=V(),o=_(),l=q(),[a,p]=i.useState(""),[c,x]=i.useState(""),[f,y]=i.useState("assessor"),[s,m]=i.useState(!0),[r,v]=i.useState(!1),[h,j]=i.useState(!1),{enqueueSnackbar:g}=Y();i.useEffect(()=>{const u=new URLSearchParams(l.search).get("tab");m(!(u==="signup"&&!n)),t()},[l.search,n,t]);const k=()=>!a||!a.includes("@")?(g("Please enter a valid email",{variant:"error"}),!1):!c||c.length<6?(g("Password must be at least 6 characters",{variant:"error"}),!1):!0,R=async()=>{if(!k())return;j(!0);const d=s?"/api/auth/login":"/api/auth/register";try{const u=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:c,role:s?void 0:f})}),L=await u.json();if(!u.ok)throw new Error(L.message||(s?"Login failed":"Registration failed"));s?(localStorage.setItem("token",L.token),g("Login successful",{variant:"success"}),o("/dashboard")):(g("Account created successfully. Please sign in.",{variant:"success"}),m(!0))}catch(u){console.error("Auth error:",u),g(u.message||"An authentication error occurred.",{variant:"error",autoHideDuration:5e3})}finally{j(!1)}},F=()=>{g("Google login is not yet implemented for this platform.",{variant:"info"})};return e.jsxs(b,{children:[e.jsx(b,{sx:{textAlign:"center",mb:3},children:e.jsx(C,{variant:"h5",component:"h1",sx:{mt:1},children:s?"Sign In to Assessly":"Create Your Assessly Account"})}),e.jsx(E,{label:"Email",type:"email",fullWidth:!0,margin:"normal",value:a,onChange:d=>p(d.target.value),autoComplete:"email",required:!0}),e.jsx(E,{label:"Password",type:r?"text":"password",fullWidth:!0,margin:"normal",value:c,onChange:d=>x(d.target.value),autoComplete:s?"current-password":"new-password",required:!0,InputProps:{endAdornment:e.jsx(ae,{position:"end",children:e.jsx(B,{onClick:()=>v(!r),edge:"end","aria-label":"toggle password visibility",children:r?e.jsx(ie,{}):e.jsx(re,{})})})}}),!s&&!n&&e.jsx(b,{sx:{mt:2},children:e.jsxs(X,{value:f,onChange:d=>y(d.target.value),fullWidth:!0,displayEmpty:!0,children:[e.jsx(P,{value:"admin",children:"Admin"}),e.jsx(P,{value:"assessor",children:"Assessor"}),e.jsx(P,{value:"candidate",children:"Candidate"})]})}),e.jsx(A,{variant:"contained",color:"primary",fullWidth:!0,onClick:R,disabled:h,startIcon:h?e.jsx(G,{size:20,color:"inherit"}):null,sx:{mt:3,py:1.5},children:h?"Processing...":s?"Sign In":"Sign Up"}),e.jsx(H,{sx:{my:3},children:"OR"}),e.jsx(A,{variant:"outlined",fullWidth:!0,onClick:F,startIcon:e.jsx(oe,{}),sx:{mb:2},children:"Continue with Google"}),!n&&e.jsx(b,{sx:{textAlign:"center",mt:2},children:e.jsxs(C,{variant:"body2",children:[s?"Don't have an account?":"Already have an account?",e.jsx(A,{color:"primary",onClick:()=>{m(!s),o(`/auth?tab=${s?"signup":"login"}`,{replace:!0})},size:"small",sx:{ml:1},children:s?"Sign up":"Sign in"})]})}),e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mt:3,textAlign:"center"},children:e.jsx(J,{to:"/forgot-password",style:{color:"inherit"},children:"Forgot password?"})})]})}export{he as default};
